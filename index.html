<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voyage — Co-founding the Future</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script type="module" crossorigin src="./index-BEfEoJVR.js"></script>
    <link rel="stylesheet" crossorigin href="./index-DGJEfosU.css">

    <!-- Company info style (injected above existing copyright, or appended at bottom as fallback) -->
    <style>
      .kz-company-in-footer{
        margin-top: 12px;
        padding-top: 10px;
        color: rgba(255,255,255,0.58);
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        font-size: 12px;
        line-height: 1.55;
        text-align: center;
      }
      .kz-company-in-footer .name{
        color: rgba(255,255,255,0.78);
        font-weight: 600;
        letter-spacing: 0.02em;
        margin-bottom: 4px;
      }
      .kz-company-in-footer .addr{
        max-width: 920px;
        margin: 0 auto;
      }
      @media (max-width: 640px){
        .kz-company-in-footer{ font-size: 11px; }
      }
    </style>
  </head>

  <body>
    <div id="root"></div>

    <!-- Formspree submit interceptor (ONLY triggers on "Submit Application/提交申请") -->
    <script>
      (function () {
        const ENDPOINT = "https://formspree.io/f/xbddgpby";
        const SUBMIT_TEXT_RE = /^(submit application|提交申请)$/i;

        let submitting = false;
        let lastSubmitAt = 0;
        const COOLDOWN_MS = 4000;

        function clean(s){ return (s||"").toString().trim().replace(/\s+/g," "); }
        function isVisible(el){
          if(!el) return false;
          const st = getComputedStyle(el);
          if(st.display==="none" || st.visibility==="hidden" || st.opacity==="0") return false;
          return el.getClientRects().length>0;
        }

        function findSubmitEl(from){
          let el = from;
          for(let i=0;i<16 && el;i++){
            const txt = clean(el.innerText || el.value || "");
            const aria = clean(el.getAttribute ? el.getAttribute("aria-label") : "");
            if(txt && SUBMIT_TEXT_RE.test(txt)) return el;
            if(aria && SUBMIT_TEXT_RE.test(aria)) return el;
            el = el.parentElement;
          }
          return null;
        }

        function findFormScope(startEl){
          let el = startEl;
          for(let i=0;i<12 && el;i++){
            const inputs = el.querySelectorAll("input, textarea, select, [contenteditable='true']");
            const visibleCount = Array.from(inputs).filter(isVisible).length;
            if(visibleCount >= 2) return el;
            el = el.parentElement;
          }
          return null;
        }

        function keyFor(el, idx){
          const n = clean(el.getAttribute && el.getAttribute("name"));
          const id = clean(el.id);
          const aria = clean(el.getAttribute && el.getAttribute("aria-label"));
          const ph = clean(el.getAttribute && el.getAttribute("placeholder"));
          return n || id || aria || ph || `field_${idx+1}`;
        }

        function collect(scope){
          const els = Array.from(scope.querySelectorAll("input, textarea, select, [contenteditable='true']"))
            .filter(isVisible)
            .filter(el => !(el.tagName==="INPUT" && (el.type||"").toLowerCase()==="hidden"))
            .filter(el => !el.disabled);

          const out = {};
          els.forEach((el, idx) => {
            const key = keyFor(el, idx);
            const tag = (el.tagName||"").toLowerCase();
            const type = ((el.getAttribute && el.getAttribute("type"))||"").toLowerCase();

            if(type==="radio"){ if(el.checked) out[key] = el.value || "on"; return; }
            if(type==="checkbox"){ out[key] = el.checked ? (el.value||"yes") : "no"; return; }
            if(tag==="select"){ out[key] = el.value ?? ""; return; }
            if(el.getAttribute && el.getAttribute("contenteditable")==="true"){ out[key] = clean(el.innerText); return; }
            out[key] = el.value ?? "";
          });

          return out;
        }

        function showMsg(anchor, ok, text){
          let box = anchor.__fsBox;
          if(!box){
            box = document.createElement("div");
            box.style.marginTop = "12px";
            box.style.padding = "10px 12px";
            box.style.borderRadius = "10px";
            box.style.fontSize = "14px";
            box.style.border = "1px solid rgba(255,255,255,0.15)";
            box.style.background = "rgba(0,0,0,0.35)";
            box.style.color = "#fff";
            anchor.parentElement && anchor.parentElement.appendChild(box);
            anchor.__fsBox = box;
          }
          box.style.borderColor = ok ? "rgba(34,197,94,0.6)" : "rgba(239,68,68,0.6)";
          box.style.background = ok ? "rgba(34,197,94,0.12)" : "rgba(239,68,68,0.12)";
          box.textContent = text;
        }

        async function post(payload){
          const controller = new AbortController();
          const t = setTimeout(() => controller.abort(), 12000);
          try{
            return await fetch(ENDPOINT, {
              method: "POST",
              headers: { "Accept":"application/json", "Content-Type":"application/json" },
              body: JSON.stringify(payload),
              signal: controller.signal
            });
          } finally {
            clearTimeout(t);
          }
        }

        document.addEventListener("click", async (e) => {
          const submitEl = findSubmitEl(e.target);
          if(!submitEl) return;

          const scope = findFormScope(submitEl);
          if(!scope) return;

          const now = Date.now();
          if (submitting) return;
          if (now - lastSubmitAt < COOLDOWN_MS) return;

          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();

          submitting = true;
          lastSubmitAt = now;

          const fields = collect(scope);
          const message = Object.entries(fields).map(([k,v]) => `${k}: ${v}`).join("\n");
          const submission_id = `${Date.now()}-${Math.random().toString(16).slice(2)}`;

          const payload = {
            ...fields,
            message,
            submission_id,
            _page: location.href,
            _ts: new Date().toISOString(),
            _subject: "New Co-founder Application"
          };

          showMsg(submitEl, true, "Submitting to Formspree…");

          try{
            submitEl.style.pointerEvents = "none";
            const res = await post(payload);
            if(res.ok){
              showMsg(submitEl, true, "✅ Submitted successfully!");
            } else {
              const body = await res.json().catch(()=>null);
              console.error("[Formspree] error:", res.status, body);
              showMsg(submitEl, false, `❌ Submit failed (${res.status}).`);
            }
          } catch (err) {
            console.error(err);
            const msg = (err && err.name==="AbortError")
              ? "❌ Submit timed out (12s). Please try again."
              : "❌ Submit failed. Please try again.";
            showMsg(submitEl, false, msg);
          } finally {
            submitEl.style.pointerEvents = "";
            submitting = false;
          }
        }, true);
      })();
    </script>

    <!-- Robust injection: insert company info ABOVE the existing copyright line; if not found, append at bottom -->
    <script>
      (function () {
        const COMPANY_NAME = "VOYAGE HOLDING LIMITED";
        const COMPANY_ADDR = "UNIT 10,17/F HORIZON EAST 1 TSAT PO STREET SAN PO KONG HK";
        const ID = "kz-company-in-footer";

        const BLOCK_HTML = `
          <div class="kz-company-in-footer" id="${ID}">
            <div class="name">${COMPANY_NAME}</div>
            <div class="addr">${COMPANY_ADDR}</div>
          </div>
        `;

        function already() { return !!document.getElementById(ID); }

        function createBlock() {
          const wrap = document.createElement("div");
          wrap.innerHTML = BLOCK_HTML.trim();
          return wrap.firstElementChild;
        }

        function findCopyrightElement() {
          // 更广的搜索范围：任何元素都可以
          const nodes = Array.from(document.querySelectorAll("footer, small, p, span, div"));
          return nodes.find(el => /ALL\s+RIGHTS\s+RESERVED/i.test((el.innerText || el.textContent || ""))) || null;
        }

        function findFooterContainer() {
          // 尽量找到页面里“最底部”的 footer 容器
          const footers = Array.from(document.querySelectorAll("footer"));
          if (footers.length) return footers[footers.length - 1];
          // fallback：root
          return document.getElementById("root") || document.body;
        }

        function injectOnce() {
          if (already()) return true;

          const copyrightEl = findCopyrightElement();
          if (copyrightEl && copyrightEl.parentNode) {
            const block = createBlock();
            copyrightEl.parentNode.insertBefore(block, copyrightEl);
            return true;
          }

          // 如果暂时找不到版权行，不立刻兜底（让 observer 再等等）
          return false;
        }

        function fallbackAppendBottom() {
          if (already()) return;
          const container = findFooterContainer();
          container.appendChild(createBlock());
        }

        // 先尝试一次
        if (injectOnce()) return;

        // 监听 DOM 变化，最长等 12 秒
        const obs = new MutationObserver(() => {
          if (injectOnce()) {
            obs.disconnect();
          }
        });

        obs.observe(document.documentElement, { childList: true, subtree: true });

        // 12 秒后仍找不到版权行：兜底放在页面最底部（保证不会“没了”）
        setTimeout(() => {
          obs.disconnect();
          if (!already()) fallbackAppendBottom();
        }, 12000);
      })();
    </script>
  </body>
</html>
